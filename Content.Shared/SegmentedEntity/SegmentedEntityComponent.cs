using Robust.Shared.GameStates;

namespace Content.Shared.SegmentedEntity;

/// <summary>
///     Controls initialization of any Multi-segmented entity
/// </summary>
[RegisterComponent, NetworkedComponent]
[AutoGenerateComponentState]
public sealed partial class SegmentedEntityComponent : Component
{
    /// <summary>
    ///     A list of each UID attached to the Lamia, in order of spawn
    /// </summary>
    [DataField, AutoNetworkedField]
    public List<NetEntity> Segments = new();

    /// <summary>
    ///     A clamped variable that represents the number of segments to be spawned
    /// </summary>
    [DataField]
    public int NumberOfSegments = 3;

    /// <summary>
    ///     How wide the initial segment should be.
    /// </summary>
    [DataField]
    public float InitialRadius = 0.3f;

    /// <summary>
    ///     Texture of the segment. Can be either a direct texture path or an RSI path (when used with TextureState).
    /// </summary>
    [DataField(required: true)]
    public string TexturePath;

    /// <summary>
    ///     Optional RSI state name to use from the RSI specified in TexturePath.
    ///     If specified, TexturePath should point to an RSI, not a direct texture.
    /// </summary>
    [DataField, AutoNetworkedField]
    public string? TextureState;

    /// <summary>
    ///     Optional shader prototype ID to apply when rendering the texture from <see cref="TexturePath"/>.
    ///     If null or invalid, rendering falls back to no shader.
    /// </summary>
    [DataField, AutoNetworkedField]
    public string? ShaderId;

    /// <summary>
    ///     If UseTaperSystem is true, this constant represents the rate at which a segmented entity will taper towards the tip. Tapering is on a logarithmic scale, and will asymptotically approach 0.
    /// </summary>
    [DataField]
    public float OffsetConstant = 1.03f;

    /// <summary>
    ///     Represents the prototype used to parent all segments
    /// </summary>
    [DataField]
    public string InitialSegmentId = "LamiaInitialSegment";

    /// <summary>
    ///     Represents the segment prototype to be spawned
    /// </summary>
    [DataField]
    public string SegmentId = "LamiaSegment";

    /// <summary>
    ///     How much to slim each successive segment.
    /// </summary>
    [DataField]
    public float SlimFactor = 0.93f;

    /// <summary>
    ///     Set to false for constant width
    /// </summary>
    [DataField]
    public bool UseTaperSystem = true;

    /// <summary>
    ///     The standard distance between the centerpoint of each segment.
    /// </summary>
    [DataField]
    public float StaticOffset = 0.15f;

    /// <summary>
    ///     The standard sprite scale of each segment.
    /// </summary>
    [DataField]
    public float StaticScale = 1f;

    /// <summary>
    ///     Used to more finely tune how much damage should be transfered from tail to body.
    /// </summary>
    [DataField]
    public float DamageModifierOffset = 0.4f;

    /// <summary>
    ///     A clamped variable that represents how far from the tip should tapering begin.
    /// </summary>
    [DataField]
    public int TaperOffset = 3;

    /// <summary>
    ///     Coefficient used to finely tune how much explosion damage should be transfered to the body. This is calculated multiplicatively with the derived damage modifier set.
    /// </summary>
    [DataField]
    public float ExplosiveModifierOffset = 0.1f;

    /// <summary>
    ///     Controls whether or not lamia segments always block bullets, or use the bullet passover system for laying down bodies.
    /// </summary>
    [DataField]
    public bool BulletPassover = true;
}
